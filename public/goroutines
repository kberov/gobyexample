<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Go в примери: Нишки (goroutines)</title>
    <link rel=stylesheet href="site.css">
  </head>
  <script>
      window.onkeydown = (e) => {
          if (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey) {
              return;
          }
          
          if (e.key == "ArrowLeft") {
              window.location.href = 'custom-errors';
          }
          
          
          if (e.key == "ArrowRight") {
              window.location.href = 'channels';
          }
          
      }
  </script>
  <body>
    <div class="example" id="goroutines">
      <h2><a href="./">Go в примери</a>: Нишки (goroutines)</h2>
      
      <table>
        
        <tr>
          <td class="docs">
            <p><em>goroutine</em><sup class="footnote-ref" id="fnref:goroutine"><a href="#fn:goroutine">1</a></sup> е лека нишка<sup class="footnote-ref" id="fnref:thread"><a href="#fn:thread">2</a></sup> на
изпълнение.</p>

<div class="footnotes">

<hr />

<ol>
<li id="fn:goroutine">goroutine – измислена за езика Го дума, за да обозначи и разграничи вида нишки в този език от другите програмни езици – подзадача, изпълняваща се едновременно с главната.</li>

<li id="fn:thread">thread – нишка (за изпълнение на поредица от указания)</li>
</ol>

</div>

          </td>
          <td class="code empty leading">
            
          
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            <a href="https://go.dev/play/p/w0uPPb7K55E"><img title="Run code" src="play.png" class="run" /></a><img title="Copy code" src="clipboard.png" class="copy" />
          <pre class="chroma"><code><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><code><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;time&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><code><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">f</span><span class="p">(</span><span class="nx">from</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="mi">3</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">from</span><span class="p">,</span> <span class="s">&#34;:&#34;</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><code><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Да предположим, че извикваме функция <code>f(s)</code> по
обичайния начин - в потока на програмата ни.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma"><code><span class="line"><span class="cl">    <span class="nf">f</span><span class="p">(</span><span class="s">&#34;пряко извикване&#34;</span><span class="p">)</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>За да извикаме тази функция като отделна нишка в
Го, пишем <code>go f(s)</code>. Тази нова „гозадача“ ще се
изпълни едновременно с извикващата я (главната
нишка).</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma"><code><span class="line"><span class="cl">    <span class="k">go</span> <span class="nf">f</span><span class="p">(</span><span class="s">&#34;извикване в отделна go-нишка&#34;</span><span class="p">)</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Можете да пуснете нова гозадача с безименна
функция.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma"><code><span class="line"><span class="cl">    <span class="k">go</span> <span class="kd">func</span><span class="p">(</span><span class="nx">msg</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}(</span><span class="s">&#34;върви&#34;</span><span class="p">)</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Двете ни извикани функции сега работят независимо
една от друга в отделни нишки (потоци) на
изпълнение. Изчакваме ги да завършат. По-мощен
подход е да ползваме <a href="waitgroups">WaitGroup</a>.</p>

          </td>
          <td class="code">
            
          <pre class="chroma"><code><span class="line"><span class="cl">    <span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;готово&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre>
          </td>
        </tr>
        
      </table>
      
      <table>
        
        <tr>
          <td class="docs">
            <p>Когато пуснем тази програма, ще видим първо изхода от
блокиращото извикване, след това изхода от две
гозадачи. Изходът от гозадачите може да се смеси,
защото са пуснати едновременно от двигателя за
изпълнение<sup class="footnote-ref" id="fnref:runtime"><a href="#fn:runtime">1</a></sup> на Го.</p>

<div class="footnotes">

<hr />

<ol>
<li id="fn:runtime">runtime – буквално „по време на изпълнение“. Това е програмен код, който става част от нашата програма и я управлява по време на изпълнение. спокойно да го преведем <em>изпълнение</em> или <em>изпълнител</em></li>
</ol>

</div>

          </td>
          <td class="code leading">
            
          <pre class="chroma"><code><span class="line"><span class="cl"><span class="gp">$</span> go run goroutines.go
</span></span><span class="line"><span class="cl"><span class="go">пряко извикване : 0
</span></span></span><span class="line"><span class="cl"><span class="go">пряко извикване : 1
</span></span></span><span class="line"><span class="cl"><span class="go">пряко извикване : 2
</span></span></span><span class="line"><span class="cl"><span class="go">извикване в отделна go-нишка : 0
</span></span></span><span class="line"><span class="cl"><span class="go">върви
</span></span></span><span class="line"><span class="cl"><span class="go">извикване в отделна go-нишка : 1
</span></span></span><span class="line"><span class="cl"><span class="go">извикване в отделна go-нишка : 2
</span></span></span><span class="line"><span class="cl"><span class="go">готово</span></span></span></code></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>В следващия пример ще разгледаме едно допълнение към
гозадачите – канали.</p>

          </td>
          <td class="code empty">
            
          
          </td>
        </tr>
        
      </table>
      
      
      <p class="next">
        Следващ пример: <a href="channels" rel="next">Канали (chan)</a>.
      </p>
      

    <p class="footer">
      от <a href="https://markmcgranaghan.com">Марк Макгранахан</a> и <a href="https://eli.thegreenplace.net">Ели Бендерски</a> | <a href="https://github.com/mmcgrana/gobyexample">изходен код</a> | <a href="https://github.com/mmcgrana/gobyexample#license">разрешително</a>
    </p>

    </div>
    <script>
      var codeLines = [];
      codeLines.push('');codeLines.push('package main\u000A');codeLines.push('import (\u000A    \"fmt\"\u000A    \"time\"\u000A)\u000A');codeLines.push('func f(from string) {\u000A    for i :\u003D range 3 {\u000A        fmt.Println(from, \":\", i)\u000A    }\u000A}\u000A');codeLines.push('func main() {\u000A');codeLines.push('    f(\"пряко извикване\")\u000A');codeLines.push('    go f(\"извикване в отделна go-нишка\")\u000A');codeLines.push('    go func(msg string) {\u000A        fmt.Println(msg)\u000A    }(\"върви\")\u000A');codeLines.push('    time.Sleep(time.Second)\u000A    fmt.Println(\"готово\")\u000A}\u000A');codeLines.push('');codeLines.push('');
    </script>
    <script src="site.js" async></script>
  </body>
</html>
